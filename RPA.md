# 影刀 RPA 开发规范

---

## 一、总体原则

### 1 技术定位

`影刀`是主流程编排工具

`Python` 只用于影刀无法完成的能力扩展
例如：

```
复杂计算
特殊接口
文件/加密/压缩
未接入 API 等
```

> 业务逻辑优先写入`影刀`，而不是`Python`

---

### 2 可维护性优先级

> `可读性` > `稳定性` > `开发速度`

```
影刀流程是给人看的，不是给机器看的。
```

---

## 二、影刀变量命名规范

### 1 总体规则

```
允许中文变量名，但必须结构化
禁止随意、口语化、歧义命名
```

---

### 2 中文变量命名统一格式

> `业务对象`\_`属性`/`状态`

##### 正确示例

```
店铺_ID
订单_列表
订单_数量
是否_登录成功
是否_存在验证码
导出_开始日期
导出_结束日期
```

##### 错误示例

```
变量1
tmp
test
这个
状态
结果
```

---

### 3 布尔变量（强制规则）

> 必须以`是否` / `有没有` / `能否`开头

##### 允许：

```
是否_登录成功
是否_需要重试
是否_存在弹窗
是否_加载完成
```

##### 禁止：

```
登录成功
状态
flag
```

---

### 4 数量 / 计数类变量

> 必须体现`单位` / `含义`

```
订单_数量
重试次数
最大_重试次数
当前页码
```

---

### 5 页面元素变量命名

> `页面` _ `元素类型` _ `名称`

```
登录页_账号_输入框
登录页_密码_输入框
订单页_导出_按钮
订单页_下一页_按钮
```

> 即使影刀本身能点元素，
> 变量名也要让人一眼知道在点什么。

---

## 三、子流程命名规范

### 1 子流程命名格式（强制）

> `动词` `for` `业务对象`

##### 允许：

```
登录for店铺
切换for店铺
进入for订单页面
导出for订单数据
处理for验证码
检查for登录状态
```

##### 禁止：

```
子流程1
流程A
处理一下
测试用
```

---

### 2 子流程粒度规范

#### 一个子流程应满足：

```
只完成一个明确动作
不超过 20～30 个节点
可以被多个主流程复用
```

##### 推荐拆分

```
登录店铺
检查是否需要验证码
处理验证码
确认登录成功
```

##### 不推荐

```
登录并导出并判断并上传
```

---

### 3️ 子流程输入 / 输出约定

##### 子流程必须在说明中写清楚：

```
使用哪些变量
会修改哪些变量
是否有返回结果
```

##### 示例（说明文本）：

```
输入
- 店铺ID
输出
- 是否登录成功
```

---

## 四、主流程命名与结构规范

### 1️ 主流程命名

> `平台` _ `业务` _ `主流程`

##### 允许：

```
拼多多_订单导出_主流程
拼多多_售后检查_主流程
拼多多_店铺日常巡检_主流程
```

##### 禁止：

```
拼多多流程
最终版本
新版流程
```

---

### 2️ 主流程标准结构

`开始`
↓
`初始化变量`
↓
`登录相关子流程`
↓
`业务处理子流程`
↓
`异常 / 重试判断`
↓
`结束`

> 主流程只做`编排`，不堆细节

---

## 五、影刀与 Python 的协作规范

### 1️ Python 的使用边界

##### Python 只能用于以下情况：

```
影刀无法实现的操作
复杂数据处理
第三方接口
批量文件处理
```

##### 禁止：

```
把整个业务流程搬到 Python
在 Python 里控制页面流程
```

---

### 2️ Python 模块命名规范

> `小写英文` \_ `小写英文`

```
pdd_order_parser.py
feishu_sheet_writer.py
file_zipper.py
```

---

### 3️ Python 函数命名规范

> `动词` \_ `名词`（Python 强制英文）

```
parse_orders()
write_to_feishu()
zip_files()
```

##### 影刀侧只关心：

```
传什么参数
拿什么结果
```

---

### 4️ 影刀 ↔ Python 参数规范

##### 推荐方式

`影刀准备变量 → 传给 Python：`

```
店铺ID
导出开始日期
导出结束日期
```

`Python 返回：`

```
是否执行成功
错误信息
```

> 影刀只判断结果，不解析过程

---

## 六、异常与重试规范

### 1️ 异常分类

##### 允许出现：

```
成功
需要重试
失败
```

##### 不允许出现：

```
好像失败
未知状态
```

---

##### 2️ 重试逻辑规范

> 重试必须在主流程统一处理

> 子流程不允许自己死循环

---

## 七、影刀流程“红线清单”

##### 以下行为一律不允许：

```
1. 中文变量名随意取

2. 主流程堆 50+ 节点

3. 子流程无说明

4. Python 中控制网页流程

5. 复制流程不改命名

6. 用“测试 / 临时 / 新版”命名交付
```

---

## 八、总结

> 影刀负责`看得见的流程`
> Python 负责`影刀做不到的能力`
> 中文变量必须`像文档一样严谨`

---
